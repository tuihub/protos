syntax = "proto3";

package librarian.sephirah.v1;

import "google/protobuf/timestamp.proto";
import "librarian/v1/common.proto";
import "librarian/v1/wellknown.proto";

option csharp_namespace = "TuiHub.Protos.Librarian.Sephirah.V1";
option go_package = "github.com/tuihub/protos/pkg/librarian/sephirah/v1;v1";

message GetServerInformationRequest {
  optional bool with_status_report = 1;
}
message GetServerInformationResponse {
  // For manual inspection only, the client may display but should not parse the response.
  ServerBinarySummary server_binary_summary = 1;
  // For manual inspection only, the client may display but should not parse the response.
  ServerProtocolSummary protocol_summary = 2;
  // The time that server received the request,
  // note that there is a transmission delay between server and client.
  google.protobuf.Timestamp current_time = 3;
  // Valid when accessToken is provided.
  optional librarian.v1.FeatureSummary feature_summary = 4;
  // For showing to user, customizable by server owner.
  ServerInstanceSummary server_instance_summary = 5;
  // Plain text status report for manual inspection.
  // Content is specific to server implementation.
  optional string status_report = 6;
}

message ServerBinarySummary {
  // Server source code address.
  // *Should* be a valid http address.
  string source_code_address = 1;
  // Binary build version.
  // The content *should* be a semantic version string similar to the one generated by `git describe`,
  // but rely on the actual implementation of the server.
  string build_version = 2;
  // Binary build date.
  // The content *should* be a date format that is human-readable.
  string build_date = 3;
}

message ServerProtocolSummary {
  // Protocol version used by server.
  // The content *must* be a semantic version string generated by `git describe`,
  // and if the server is built for production, it *must* be a valid version tag.
  string version = 1;
}

message ServerInstanceSummary {
  string name = 1;
  string description = 2;
  string website_url = 3;
  string logo_url = 4;
  string background_url = 5;
}

message FileMetadata {
  librarian.v1.InternalID id = 1;
  string name = 2;
  int64 size_bytes = 3;
  FileType type = 4;
  bytes sha256 = 5;
  google.protobuf.Timestamp create_time = 6;
}

enum FileType {
  FILE_TYPE_UNSPECIFIED = 0;
  FILE_TYPE_GEBURA_SAVE = 1;
  FILE_TYPE_CHESED_IMAGE = 2;
}
