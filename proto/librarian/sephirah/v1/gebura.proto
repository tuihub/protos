syntax = "proto3";

package librarian.sephirah.v1;

import "librarian/sephirah/v1/base.proto";
import "librarian/v1/common.proto";

option csharp_namespace = "TuiHub.Protos.Librarian.Sephirah.V1";
option go_package = "github.com/tuihub/protos/pkg/librarian/sephirah/v1;v1";

message CreateAppRequest {
  // `id` can be anything, `source` must be APP_SOURCE_INTERNAL
  librarian.v1.App app = 1;
}
message CreateAppResponse {
  librarian.v1.InternalID id = 1;
}

message UpdateAppRequest {
  // source must be APP_SOURCE_INTERNAL
  librarian.v1.App app = 1;
}

message UpdateAppResponse {}

message ListAppRequest {
  librarian.v1.PagingRequest paging = 1;
  repeated librarian.v1.AppSource source_filter = 2;
  repeated librarian.v1.AppType type_filter = 3;
  repeated librarian.v1.InternalID id_filter = 4;
  bool contain_details = 5;
}

message ListAppResponse {
  librarian.v1.PagingResponse paging = 1;
  repeated librarian.v1.App app_list = 2;
}

message BindAppRequest {
  librarian.v1.InternalID internal_app_id = 1;
  librarian.v1.AppID bind_app_id = 2;
}

message BindAppResponse {
  librarian.v1.InternalID bind_app_id = 1;
}

message UnBindAppRequest {
  librarian.v1.InternalID internal_app_id = 1;
  librarian.v1.InternalID bind_app_id = 2;
}

message UnBindAppResponse {}

message ListBindAppRequest {
  librarian.v1.InternalID app_id = 1;
}

message ListBindAppResponse {
  repeated librarian.v1.App app_list = 1;
}

message RefreshAppRequest {
  librarian.v1.InternalID app_id = 1;
}

message RefreshAppResponse {}

message CreateAppPackageRequest {
  librarian.v1.AppPackage app_package = 1;
}

message CreateAppPackageResponse {
  librarian.v1.InternalID id = 1;
}

message UpdateAppPackageRequest {
  librarian.v1.AppPackage app_package = 1;
}

message UpdateAppPackageResponse {}

message ListAppPackageRequest {
  librarian.v1.PagingRequest paging = 1;
  repeated librarian.v1.AppPackageSource source_filter = 2;
  repeated librarian.v1.InternalID id_filter = 3;
  repeated librarian.v1.InternalID bind_app_id_filter = 4;
}

message ListAppPackageResponse {
  librarian.v1.PagingResponse paging = 1;
  repeated librarian.v1.AppPackage app_package_list = 2;
}

message ReportAppPackageRequest {
  map<string, librarian.v1.AppPackageBinary> app_package_list = 1;
}

message ReportAppPackageResponse {}

message BindAppPackageRequest {
  librarian.v1.InternalID app_id = 1;
  librarian.v1.InternalID app_package_id = 2;
}

message BindAppPackageResponse {}

message UnBindAppPackageRequest {
  librarian.v1.InternalID app_package_id = 1;
}

message UnBindAppPackageResponse {}

message UploadGameSaveFileRequest {
  FileMetadata file_metadata = 1;
  librarian.v1.InternalID app_package_id = 2;
}

message UploadGameSaveFileResponse {
  string upload_token = 1;
}

message DownloadGameSaveFileRequest {
  librarian.v1.InternalID id = 1;
}

message DownloadGameSaveFileResponse {
  string download_token = 2;
}

message ListGameSaveFileRequest {
  librarian.v1.PagingRequest paging = 1;
  librarian.v1.InternalID app_package_id = 2;
}

message ListGameSaveFileResponse {
  librarian.v1.PagingResponse paging = 1;
  repeated FileMetadata file_list = 2;
}
